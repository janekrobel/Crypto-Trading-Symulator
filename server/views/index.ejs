<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/index.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <title>Document</title>
</head>
<body>
    <header>
        <img src="">
        <p id="balance">Balance: <%=totalBalance%></p>
        <p id="email" class="email"><%=account.email%></p>
        <button>Log Out</button>
    </header>
    <div class="tradePanel">
        <p class="title">Open a position:</p>
        <div id="panel" class="panel">
            <p id="availableBalance">Available Balance: <%=account.balance%></p>
            <form method="post" id="position" class="tradeInput" action="/positions">
                <select name="coin_id" id="coin_id">
                    <% for (coin of coins) { %>
                        <option value="<%= coin.id %>"><%= coin.symbol %></option>
                    <% } %>
                </select>
                <input name="email" value="<%=account.email%>" hidden><%=account.email%></p>                
                <p id="currentPrice">Current Price:</p>
                <input class="priceInput" name="amounts"></input>
                <input name="type" value="Long" type="submit"></input>
                <input name="type" value="Short" type="submit"></input>
            </form>
        </div>
    </div>
    <div class="positionsPanel">
        <p class="title">Your Positions: </p>
        <p id="totalValue">Total Value: <%=totalValue%></p>
        <table>
            <thead>
                <tr>
                    <th>Coin</th>
                    <th>Price</th>
                    <th>Amounts</th>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Close</th>
                </tr>
            </thead>
            <tbody>
                <%for(position of positions){%>
                    <tr>
                        <td><%=position.id_coin%></td>
                        <td><%=position.price%></td>
                        <td><%=position.amounts%></td>
                        <td><%=position.date%></td>
                        <td><%=position.type%></td>
                        <td><a href='/positions/close/?id=<%=position.id%>'>Close</a></td>
                    </tr>
                <%}%>
            </tbody>
        </table>
    </div>
    <div class="currenciesPanel">
        <p class="title">All Currencies:</p>
        <table id="coinTable">
            <thead>
              <tr>
                <th>Icon</th>
                <th>Symbol</th>
                <th>Name</th>
                <th>Price</th>
                <th>Volume 24h</th>
                <th>Market Cap</th>
                <th>Change</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <%for(coin of coins){%>
                <tr>
                  <td><img width="50px" src="<%=coin.iconUrl%>"/></td>
                  <td><%=coin.symbol%></td>
                  <td><%=coin.name%></td>
                  <td><%=coin.price%></td>
                  <td><%=coin.volumen24%></td>
                  <td><%=coin.marketCap%></td>
                  <td><%=coin.priceChange%></td>
                  <td><button onClick="changeCurrent(<%=coin.id%>)" id="btnCoin<%=coin.id%>">Buy/Sell</button></td>
                </tr>
              <%}%>
            </tbody>
        </table>
    </div>
    <style>   

        body {
            font-family: 'Roboto';
            margin: 0px;

        }
        table {
        border-collapse: collapse;
        width: 80%;
        margin-left: auto;
        margin-right: auto;
        border-spacing: 0 15px;
        }

        th,
        td {
        text-align: left;
        padding: 12px;
        border-bottom: 1px solid #ddd;
        }

        .tradePanel{
            width: 80%;
            border: #333;
        }

        th {
        background-color: #e6e6e6;
        color: #333;
        }

        tbody tr:hover {
        background-color: #f5f5f5;
        }

        tbody tr{
            box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);

        }

        button {
        border-radius: 10px;
        background-color: orange;
        border: none;
        padding: 8px 16px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 14px;
        margin: 4px 2px;
        cursor: pointer;
        transition: 0.5s;
        box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
        }

        .panel{
            width: 911px;
            height: 364px;
            background: #FFFFFF;
            border: 1px solid #C4C4C4;
            box-shadow: 0px 8px 8px rgba(0, 0, 0, 0.25);
            border-radius: 5px;
            margin-left: auto;
            margin-right: auto;
        }


        button:hover{
            transform: scale(1.1)
        }

        button:hover {
        opacity: 0.8;
        }

        .title {
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 10px;
        }
        header{
            display: flex;
            flex-direction: row;
            background-color: #101014;
            margin-top: -10px;
            width: 100%;
        }
        #email{
            color: whitesmoke;
        }
        #balance{
            color: whitesmoke;
        }

    </style>
    <script>
        const myTable = document.getElementById('coinTable');  
        const select = document.getElementById('coin_id');

        // let tableCounter = 1;

        // for (let row of myTable.rows) {
        //     const btn = document.getElementById('btnCoin'+ tableCounter);
          
            
        //     btn.addEventListener('click', function handleClick(){
        //         select.value = row.cells[0];
        //     });
        //     tableCounter++;
        
        // }   

        // const balance = document.getElementById('balance');  

        function changeCurrent(id){
            console.log("Funkcja = " , id)
            select.value = id;
            window.scrollTo(0, 0)
        }
    </script>
</body>
</html>

