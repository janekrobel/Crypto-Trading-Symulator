<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/index.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <title>Document</title>
</head>
<body>
    <header>
        <img src="">
        <p id="balance">Balance: </p>
        <p id="email"></p>
        <button>Log Out</button>
    </header>
    <div class="tradePanel">
        <p class="title">Open a position:</p>
        <div class="panel">
            <p id="availableBalance">Available Balance:</p>
            <form method="post" id="position" class="tradeInput" action="/position">
                <select name="coin_id" id="coin_id">
                    <% for (coin of coins) { %>
                        <option value="<%= coin.id %>"><%= coin.symbol %></option>
                    <% } %>
                </select>                
                <p id="currentPrice">Current Price:</p>
                <input class="priceInput" name="amounts"></input>
            </form>
            <button>Buy</button>
            <button>Sell</button>
        </div>
    </div>
    <div class="positionsPanel">
        <p class="title">Your Positions: </p>
        <p id="totalValue">Total Value:</p>
        <table>
            <thead>
                <tr>
                    <th>Coin</th>
                    <th>Price</th>
                    <th>Amounts</th>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Close</th>
                </tr>
            </thead>
            <tbody>
                <%for(position of positions){%>
                    <tr>
                        <td><%=position.id_coin%></td>
                        <td><%=position.price%></td>
                        <td><%=position.amounts%></td>
                        <td><%=position.date%></td>
                        <td><%=position.type%></td>
                        <td><a href='/positions/close/?id=<%=position.id%>'>Close</a></td>
                    </tr>
                <%}%>
            </tbody>
        </table>
    </div>
    <div class="currenciesPanel">
        <p class="title">All Currencies:</p>
        <div class="columnNames">
            <p>Symbol</p>
            <p>Name</p>
            <p>Price</p>
            <p>Volume</p>
            <p>Market Cap</p>
            <p>Change</p>
        </div>
        <table id="coinTable">
            <thead>
              <tr>
                <th>Symbol</th>
                <th>Name</th>
                <th>Price</th>
                <th>Volume</th>
                <th>Market Cap</th>
                <th>Change</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <%for(coin of coins){%>
                <tr>
                  <td><%=coin.symbol%></td>
                  <td><%=coin.name%></td>
                  <td><%=coin.price%></td>
                  <td><%=coin.volume%></td>
                  <td><%=coin.marketCap%></td>
                  <td><%=coin.change%></td>
                  <td><button id="btnCoin<%=coin.id%>">Buy/Sell</button></td>
                </tr>
              <%}%>
            </tbody>
        </table>
    </div>
    <style>   

        body {
            font-family: 'Roboto';
        }
        table {
        border-collapse: collapse;
        width: 100%;
        margin: 20px 0;
        }

        th,
        td {
        text-align: left;
        padding: 12px;
        border-bottom: 1px solid #ddd;
        }

        .tradePanel{
            width: 80%;
            border: #333;
            
        }

        th {
        background-color: #e6e6e6;
        color: #333;
        }

        tbody tr:hover {
        background-color: #f5f5f5;
        }
        button {
        border-radius: 10px;
        background-color: orange;
        border: none;
        padding: 8px 16px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 14px;
        margin: 4px 2px;
        cursor: pointer;
        transition: 0.5s;
        }

        .panel{
            width: 911px;
            height: 364px;
            background: #FFFFFF;
            border: 1px solid #C4C4C4;
            box-shadow: 0px 10px 10px rgba(0, 0, 0, 0.25);
            border-radius: 5px;
        }


        button:hover{
            transform: scale(1.1)
        }

        button:hover {
        opacity: 0.8;
        }

        .title {
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 10px;
        }
    </style>
    <script>
        const myTable = document.getElementById('coinTable');  
        const select = document.getElementById('coin_id');

        let tableCounter = 1;

        for (let row of myTable.rows) {
            const btn = document.getElementById('btnCoin'+ tableCounter);
            btn.addEventListener('click', function handleClick(){
                select.value = row.cells[0];
            });
            tableCounter++;
        }   
    </script>
</body>
</html>

